# ๐ฆ ุจุฑููุช Replit โ ุชูุนูู ูุธุงู ุงูุชุนูู ุงูุฐุงุชู ุงูุฎุงุต ููู ูุณุชุฎุฏู

"""
๐ฏ ุงููุฏู:
ูุธุงู ูุชุนูู ุฐุงุชูุงู ูู ุฃู ูุตุฏุฑ ุจูุงูุงุช ูุฑุจุทู ุงูุนููู (ูุซู Google Sheetุ CRMุ ูุงุชุณุงุจ...)
ุจุญูุซ ูุชุนูู ุงููุธุงู ูู ุจูุงูุงุช ูู ุนููู ุจุดูู ูููุตูุ ููุทููุฑ ุฑุฏูุฏู ูุชุนุงููุงุชู ูุน ุนููุงุก ุฐูู ุงูุนููู ููุท.

๐ก ูุจุฏุฃ ุงูุนูู:
1. ูู ุนููู ูุฑุจุท ุฏุงุชุง ูุนููุฉ (CRM, Sheet, WhatsApp Logs)
2. ูุชู ุญูุธ ูุชุญููู ูุฐู ุงูุจูุงูุงุช ุฏุงุฎู ูุฌูุฏ ูููุตู ุฃู ุฌุฏูู ุฎุงุต (user-specific)
3. ูุชู ุชุญููู ุงูููุท + ุชูููุฏ ุฃูุงูุฑ ุฐููุฉ + ุชุฎุตูุต ุงูุฑุฏูุฏ
4. ุชูุณุชุฎุฏู ูุฐู ุงููุชุงุฆุฌ ุญุตุฑููุง ุนูุฏ ุงูุชุนุงูู ูุน ุนููุงุก ูุฐุง ุงูุนููู
"""

# โ ุงูุฌุฒุก ุงูุฃูู: ุชุนุฑูู ุงููููุฉ ูุฑุจุท ุงูุจูุงูุงุช
client_id = "company_001"  # ูุชู ุชุญุฏูุฏู ุชููุงุฆููุง ููู ูุณุชุฎุฏู
linked_data = {
    "google_sheet": "https://docs.google.com/spreadsheets/d/xxx",
    "crm_data": "https://api.crm.com/v1/clients?token=yyy",
    "whatsapp_logs": "gs://siadah-data/company_001/logs.json"
}

# โ ุงูุฌุฒุก ุงูุซุงูู: ุญูุธ ุงูุจูุงูุงุช ูู ูุญุฏุฉ ูููุตูุฉ ููู ูุณุชุฎุฏู
import os
from pathlib import Path

client_data_dir = Path(f"./data/{client_id}")
client_data_dir.mkdir(parents=True, exist_ok=True)

# ุชูุฒูู ุงูุจูุงูุงุช ูุญูุธูุง ูุคูุชุงู
import requests

for source_name, url in linked_data.items():
    response = requests.get(url)  # ุฃู ุงุณุชุฎุฏุงู gspread/BigQuery/CRM API
    with open(client_data_dir / f"{source_name}.json", "wb") as f:
        f.write(response.content)

# โ ุงูุฌุฒุก ุงูุซุงูุซ: ุชุญููู ุงูุจูุงูุงุช ูุชูููุฏ ุฃูุงูุฑ ุฐููุฉ ุฎุงุตุฉ ุจูุฐุง ุงูุนููู ููุท
import json
from openai import OpenAI

openai = OpenAI(api_key="your_openai_key")

all_messages = []
for file in client_data_dir.glob("*.json"):
    data = json.load(open(file))
    all_messages.append(str(data))

analysis_prompt = f"""
ุฃูุช ูุณุงุนุฏ ุฐูุงุก ุตูุงุนู ุชุชุนูู ูู ุจูุงูุงุช ูุฐุง ุงูุนููู ููุท.
ุญูู ูุฐู ุงูุจูุงูุงุช:
{all_messages[:2]}...

ุงุณุชุฎุฑุฌ ุฃูู ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ ุงูุชู ููุงุฌููุง ุนููุงุก ูุฐุง ุงูุนููู.
ุงูุชุฑุญ ุฑุฏูุฏูุง ูุฎุตุตุฉ ุจุงูููุฌุฉ ุงูุณุนูุฏูุฉ.
ูุงูุชุจ ุฃูุงูุฑ ุฐููุฉ ูููู ุชูุนูููุง ุชููุงุฆููุง (if โ then style).
"""

result = openai.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "system", "content": analysis_prompt}]
)

smart_actions = result.choices[0].message.content

with open(client_data_dir / "smart_actions.txt", "w") as f:
    f.write(smart_actions)

print("โ ุชู ุชูููุฏ ุงูุฑุฏูุฏ ูุงูุฃูุงูุฑ ุงููุฎุตุตุฉ ุจูุฌุงุญ")
